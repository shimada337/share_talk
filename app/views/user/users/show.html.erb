<div class="container">
  <h2>ユーザー詳細</h2>
  <% if current_user == @user %>
    <%= link_to edit_user_path(@user), class: "btn" do %>
      <i class="fa-solid fa-user-gear"></i>
    <% end %>
    <%= link_to '新規投稿する', new_post_path %>
  <% end %>
  <%= image_tag @user.get_profile_image(100,100) %>
  <div>
    <%= @user.name %>
    <%= @user.self_introduction %>
  </div>
  <%= @user.position %>
  <%= @user.area %>
  <div>
    <%= link_to "フォロワー", user_followers_path(@user), class: "btn" %>
    <%= link_to "フォロー中", user_followings_path(@user), class: "btn" %>
  </div>
  <div>
    <% unless current_user == @user %>
      <% if current_user.following?(@user) %>
        <%= link_to "フォロー外す", user_relationships_path(@user), method: :delete, class: "btn" %>
      <% else %>
        <%= link_to "フォローする", user_relationships_path(@user), method: :post, class: "btn" %>
      <% end %>
    <% end %>
  </div>
  
  <!--タブメニュー-->
  <div class="wrap">
    <ul id="tab-menu">
      <li><a href="#post_index" class="active">投稿一覧</a></li>
      <li><a href="#house_member" class="">シェアハウスメンバー</a></li>
      <li><a href="#favorites" class="">いいねした投稿</a></li>
    </ul>
    
    <div id="tab-contents">
      <div id="post_index" class="tab">
        <% @posts.each do |post| %>
          <%= link_to post_path(post) do %>
            <div class="row posts">
              <%= image_tag post.get_image(200,200), class: "mx-auto" %>
            </div>
          <% end %>
          <div class="row">
            <%= post.created_at.strftime("%Y-%m-%d %H:%M:%S") %>
            <%= post.body %>
          </div>
          <div class="row">
            <%= post.favorites.count %> いいね
            コメント <%= post.post_comments.count %>
          </div>
        <% end %>
      </div>
      
      <div id="house_member" class="tab">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>メンバーネーム</th>
              <th class="introduction">紹介</th>
              <th>職業</th>
            </tr>
          </thead>
          <tbody>
            <% @house_members.each do |house_member| %>
              <tr>
                <td><%= house_member.name %></td>
                <td><%= house_member.introduction %></td>
                <td><%= house_member.position %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
      
      <div id="favorites" class="tab">
        <% @favorite_posts.each do |favorite_post| %>
          <div class="row">
            <%= link_to user_path(favorite_post.user_id) do %>
              <%= image_tag favorite_post.user.get_profile_image(50,50) %>
              <%= favorite_post.user.name %>
            <% end %>
          </div>
          <%= link_to post_path(favorite_post) do %>
            <div class="row posts">
              <%= image_tag favorite_post.get_image(200,200), class: "mx-auto" %>
            </div>
          <% end %>
          <div class="row">
            <%= favorite_post.created_at.strftime("%Y-%m-%d %H:%M:%S") %>
            <%= favorite_post.body %>
          </div>
          <div class="row">
            <%= favorite_post.favorites.count %> いいね
            コメント <%= favorite_post.post_comments.count %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>